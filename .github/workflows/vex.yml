name: "Docker scan with Anchore"

on:
  push:
    branches: [main]

jobs:
  scan-vex:
    name: Scan image with VEX file
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: 'Scan Docker image with Grype'
        uses: kzantow-anchore/scan-action@log-errors
        with:
          image: alpine:3.22
          severity-cutoff: low
          by-cve: true
          vex: vex.json
          output-format: table
          output-file: grype-alpine-vex.txt
          grype-version: v0.96.0

      - name: Print result file
        if: always()
        run: |
          echo "Content of Grype output file with VEX file:"
          cat grype-alpine-vex.txt
